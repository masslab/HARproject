# Code Book for UCI HAR Data Cleanup
Version 1.0

November 20, 2014

written by S. Mass for JHSPH DSS Coursera 'Getting & Cleaning Data' course

## Overview
This project required the creation of a script to perform general clean-up of the UCI HAR dataset, recombining several individual datasets contained therein, reduction of the scope and reorganization of the resulting dataset and then reporting aggregate data. The principle processing cleans-up and renames the variables in the data set (see below for details) and then subsets only the mean and standard deviation data to produce a reduced dimension aggregate data frame that contains means for each activity by each subject.


## Variables & Data
The following data frames are created by the script (in alphabetical order):

- activity (contains `activity_labels.txt`)
- AlmostTidyData (intermediate for creating final output)
- combinedDF (intermediate for creating `AmostTidyData`)
- features (contains `features.txt`)
- mstd (for mean and sd variables only)
- nameKey (a convenience feature for referencing new names to original names)
- newDF (combines the testing and training data)
- newFeatures (for making the `nameKey`)
- newSubject (for adding subjects to the combined data frame)
- newY (for adding the activities to the combined data frame)
- subject_test (for adding test subjects to `newSubject`)
- subject_train (for adding training subjects to `newSubject`)
- testDF (contains `X_test.txt`)
- tidyData (final output)
- trainDF (contains `X_train.txt`)
- y_test (contains `y_test.txt`)
- y_train (contains `y_train.txt`)

The following variables are created by the script (in alphabetical order):

- activityName [chr] vector containing activity labels from activity data frame
- activityNum [int] vector containing the numeric codes from activity data frame
- badNames [Factor] containing the original variable names from X_test (header)
- bigBodyNames [chr] used for removing 'BodyBody' typo from variable names
- bigfNames [chr] used for converting 'f' to 'FFT' in variable names
- bigGoodNames [chr] used for storing the entire 561 variables after transformations
- bigMeans [chr] used for converting 'mean' to 'Mean'
- bigNoPeriods [chr] used for removing internal periods and terminal elipes
- bigtNames [chr] used for converting 't' to 'Total' in variable names
- cols2 [chr] used for creating column headers in almostTidyData
- dots [List] used for aggregating final output
- legalNames [chr] holds output from `make.names()`
- namedActivities [chr] holds activities from activityName applied to entire data set
- newActivityCode [int] hold activity codes from entire data set before converting to names
- newSubjectCode [int] holds subject codes for entire data set
- reducedNames [chr] variable names used for mstd data frame used for nameKey

## Transformations & Processing
The following operations are performed:

#### Original Variable Names are Transformed
The variable names in the test and train data sets were changed according to the following rules:

1. `make.names()` was applied to remove reserved words and illegal characters

2. Leading 't' prefixes  were changed to 'Total'

3. Leading 'f' prefixes were changed to 'FFT' (for fast Fourier transform)

4. Trailing lowercase 'mean' was changed to 'Mean' for increased readability

5. Trailing lowercase 'std' was changed to 'STD' for increased readability

6. A pervasive typographical error (BodyBody) was fixed by removing the duplication

7. The resulting variable names were *cleaned* to remove internal periods and trailing elipses (some of these were artifacts of the `make.names()` operation)

8. Trailing 'X', 'Y', and 'Z' were maintained as terminal uppercase letters even though they sometimes decreased readability in order to preserve the cartesian coordinate pertaining to the variable.

##### Variable name key
The script creates a key called `nameKey.txt` which is part of the output (see Output below).  This key lists all 86 variables (columns) that are in the final data set as rows.  The first column indicates the original variable column number [1:561] while the second column contains the original name and the third column contains the transformed name. This is for convenience only and will permit the researcher/analyst to clearly understand which variables in the resulting output files correspond to which variables in the original data set.

**Note** The column headers in the final output (the variable names) are not identical to the names in `nameKey` in one respect only: the variable name is prepended by 'mean' and enclosed in parentheses to indicate that these are averages of that variable.


## Output
The following output is generated by `run_analysis.R`:

1. a new subdirectory named `tidyFiles` is created in the working directory

2. a text file named `tidyData.txt` is written to the `tidyFiles` directory

3. a text file named `nameKey.txt` is written to the `tidyFiles` directory

#### tidyData.txt
This text file is the main output of the script and contains 180 observations of 88 variables.  It is a wide format tidy data set that aggregates the means of each of the 86 variables identified in the instructions (variables with means and standard deviations) sorted by activity and subject, which are columns 1 and 2 respectively.

#### nameKey.txt
This text file was described above in detail and is provided for convenience to enable cross-referencing of the new transformed variable names in the tidy data with the original variable names.